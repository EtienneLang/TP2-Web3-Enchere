{% extends "base.jinja" %}

{% block contenu %}
    <section class="section-details">
        <img src="https://picsum.photos/seed/{{ enchere.id_enchere }}/300/300" alt="Image pour l'enchère {{ enchere.titre }}">
        <div class="p-4">
            <h2>{{ enchere.titre }}</h2>
            <p>{{ enchere.description }}</p>
            <p>Date limite : {{ enchere.date_limite }}</p>
            {% if enchere.est_active%}
                <p><i><strong>(Active)</strong></i></p>
            {% else %}
                <p>(Inactive)</p>
            {% endif %}
            {% if enchere.mise_max %}
                {% if  enchere.est_active %}
                    <h3>Mise la plus haute pour cette enchère : {{ enchere.mise_max }}$</h3>
                    {% if enchere.fk_vendeur == session.utilisateur.id_utilisateur %}
                        <p>La mise a été fait par {{ enchere.miseur }}</p>
                    {% endif %}
                {% else %}
                    <h3>L'item s'est vendu pour : {{ enchere.mise_max }}$</h3>
                    {% if enchere.fk_vendeur == session.utilisateur.id_utilisateur %}
                        <p>L'item a été acheté par {{ enchere.miseur }}</p>
                    {% endif %}
                {% endif %}

            {% else %}
                {% if enchere.est_active %}
                    <h3>Aucune mise sur cette enchère</h3>
                {% else %}
                    <h3>Cet item ne s'est pas vendu</h3>
                {% endif %}
            {% endif %}
            {% if session.utilisateur and enchere.est_active and enchere.fk_vendeur != session.utilisateur.id_utilisateur%}
                <form action="/details/{{ enchere.id_enchere }}/miser" method="POST">
                    <input class="{{ classe_mise }}" type="text" placeholder="Somme de la mise" id="txt_mise" name="txt_mise">
                    <div class="invalid-feedback">{{ texte_erreur_mise }}</div>
                    <button type="submit" class="btn btn-primary">Miser</button>
                </form>
            {% endif %}
            {% if session.utilisateur.est_admin %}
                {% if enchere.est_supprimee %}
                    <form method="post" action="/encheres/{{ enchere.id_enchere }}/supprimer">
                        <button type="submit" class="btn btn-primary">Annuler la suppression</button>
                    </form>
                {% else %}
                    <form method="post" action="/encheres/{{ enchere.id_enchere }}/supprimer">
                        <button type="submit" class="btn btn-primary">Supprimer l'enchère</button>
                    </form>
                {% endif %}
            {% endif %}
        </div>
    </section>
{% endblock %}